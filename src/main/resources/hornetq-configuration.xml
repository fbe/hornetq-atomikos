<?xml version="1.0" encoding="UTF-8"?>
<!-- Be careful, the build process is filtering this file (placeholder substitution). 
	See pom.xml for details and. -->
<configuration xmlns="urn:hornetq"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:hornetq /schema/hornetq-configuration.xsd">

	<persistence-enabled>false</persistence-enabled>
	<!-- Connectors -->

	<clustered>true</clustered>
	<connectors>
		<connector name="in-vm">
			<factory-class>org.hornetq.core.remoting.impl.invm.InVMConnectorFactory
			</factory-class>
		</connector>

		<connector name="twinConnector">
			<factory-class>org.hornetq.core.remoting.impl.netty.NettyConnectorFactory
			</factory-class>
			<param key="host" value="${hornetq.twinCluster.twinHost}" />
			<param key="port" value="${hornetq.twinCluster.twinPort}" />
		</connector>
		
		<connector name="netty">
			<factory-class>org.hornetq.core.remoting.impl.netty.NettyConnectorFactory</factory-class>
			<param key="host" value="${hornetq.twinCluster.localHostname}" />
			<param key="port" value="${hornetq.twinCluster.localPort}" />
		</connector>
	</connectors>

	<acceptors>
		<acceptor name="in-vm">
			<factory-class>org.hornetq.core.remoting.impl.invm.InVMAcceptorFactory</factory-class>
		</acceptor>
		<acceptor name="netty">
			<factory-class>org.hornetq.core.remoting.impl.netty.NettyAcceptorFactory</factory-class>
			<param key="host" value="${hornetq.twinCluster.localHostname}" />
			<param key="port" value="${hornetq.twinCluster.localPort}" />
		</acceptor>
	</acceptors>

	<!-- required because async io doesn't work for me -->
	<!-- TODO test with async io and tx commit for each message -->
	<journal-type>NIO</journal-type>

	<!-- Other config -->


	<!-- cluster -->
	<cluster-connections>
		<cluster-connection name="twinCluster">
			<address>#</address>
			<connector-ref>netty</connector-ref>
			<retry-interval>500</retry-interval>
			<use-duplicate-detection>true</use-duplicate-detection>

			<forward-when-no-consumers>false</forward-when-no-consumers>
			<max-hops>1</max-hops>
			<static-connectors>
				<!-- Without this the connection factory wonâ€™t be able to reconnect on 
					failback -->
				<!-- <connector-ref>netty-backup</connector-ref> -->

				<!-- References to all the other nodes in the cluster -->
				<connector-ref>twinConnector</connector-ref>
			</static-connectors>
		</cluster-connection>
	</cluster-connections>

	<security-settings>
		<security-setting match="#">
			<permission type="createDurableQueue" roles="guest" />
			<permission type="deleteDurableQueue" roles="guest" />
			<permission type="createNonDurableQueue" roles="guest" />
			<permission type="deleteNonDurableQueue" roles="guest" />
			<permission type="consume" roles="guest" />
			<permission type="send" roles="guest" />
		</security-setting>
	</security-settings>

</configuration>
